# 数据链路层
1. 作用
2. 信道类型
+ 点对点通道:使用一对一的点对点通信
+ 广播通道：一对多的广播通信方式 需要专用的信道协议来协调主机的数据发送
有个设计模式很像啊
3. 简单模型
## 使用点对点信道的数据链路
1. 概念
+ 链路：一条无源的点到点的物理线路段  中间没有任何其他的交换结点
+ 数据链路：需要通信协议来控制数据的传输 把实现这些协议的硬件和软件加到链路上 构成数据链路
使用 适配器 网卡来实现这些协议的硬件和软件
一般的适配器 包括数据链路层和物理层
2. 传输流程

3. 三个问题
传递数据 数据中出现转移字符 类比富文本中出现了html脚本一样
1. 封装成帧
在数据的前后添加首部和尾部 构成一个帧  首部和尾部确认了帧的定界
用控制字符来进行帧定界
SOH + 数据部分 + EOH
SOH：帧开始符
EOH：帧结尾符
2.  透明传输
发送端在传输数据中出现了 控制字符 SOH或EOH 导致 解析的时候 错误的估算了帧开始符和帧结尾符  形成了错误的帧数据
解决方案：发送端的数据链路层 在 数据中出现 控制字符 SOH 和EOH前 提前前面插入一个转义字符 ESC （大小为1B）
如果传输数据出现了转义字符 就在前面再加一个
+ 字节填充/字符填充：接收端的数据链路层在传递给网络层之前删除插入的转义字符 如果有两个转义字符则 保留一个

3. 差错控制：传输的过程
+  比特差错：传输的数据 0 变成 1 1变成0
+  误码率：传输错误的比特占所输比特总数的比率的百分比  误码率与信噪比有很大关系

+  差错控制措施 保证数据的可靠性
+  循环冗余检验CRC技术
在发送端 将数据进行分组 每一组K个数据 在其数据后续加入 n位冗余码一起发送
+ 冗余码的计算(重点)
数据M
位数k
冗余码数n
除数P
余数R
商Q
+ 帧检验序列FCS：数据后面添加的冗余码 CRC并不是获取FCS的唯一方法(还有其他)
接收端对接收到的每一帧进行CRC判断 若得出余数R =0 则判定这个帧没错  部位0则判断这个帧有差异 丢弃
这个检测不能知道具体哪个比特出错 只能 进行整段式接收和丢弃  也就说无差错接受
0. 这里需要补习一下二进制的加减乘除
## 点对点协议PPP(point to point protocol)
1. ppp 协议满足的要求
+ 简单
+ 封装成帧
+ 透明性
+ 多种网络层协议
+ 多种类型链路
+ 差错检测
+ 检测连接状态
+ 最大传送单元
+ 网络层地址协商
+ 数据压缩协商

2. 不需要的功能
+ 纠错
+ 流量控制
+ 序号
+ 多点线路
+ 半双工或单工链路

3. ppp协议的组成
+ 一个将IP数据报封装到串行链路的方法
+ 链路控制协议LCP（link control protocol）
+ 网络控制协议NCP（network control protocol）

4. PPP协议的帧格式
+ 标志字段 F = 0x7E 看起来是开始和结尾
+ 地址字段 A= 0xFF 实际不起作用
+ 控制字段 C=0x03 
PPP是面向字节的 所有的ppp帧长度都是整数字节
**数据格式如下**
首部：F + A + C + 协议
信息部分: IP数据报Or ppp链路控制数据 Or 网络控制数据
尾部:FCS + F
信息部分的数据与 首部2个字节的协议字段有关
协议字段为0x0021时 IP数据报
         0xC021时 ppp链路控制数据
         0x8021时 网络控制数据

5. PPP协议对于透明传输问题的解决
+ PPP用于同步传输链路时 协议采用硬件来完成比特填充 与HDLC一致(HDLC是啥?)

+ PPP用于异步传输时 使用一种特殊的字符填充法
将信息字段出现的每一个0x7E(标志字符)  拆分为2字节序列(0x7D,0x5E)
若信息字段中出现一个0x7D字节 则转变为2字节序列(0x7D,0x5D)
若信息字段出现ASCII码的控制字符 数值小于0x20 则在该字符前面加入一个0x7D字节 同事将该字符的编码加以改变

+ 零比特填充
+ PPP协议在SONET(同步光纤网)/SDH链路时 使用同步传输(一连串的比特连续传送) PPP协议采用零比特填充的方法实现透明传输
+ 发送端 只要发现有连续5个1出现 就立即在其后填入一个0 接收端则对帧的数据流进行扫描 发现5个连续的1时就把后续给删除

+ 不使用序号和确认机制(这两者又是 前面有一个确认和重传的功能)的原因
数据链路层出错概率不大 比较easy的PPP协议比较合适
因特网网络环境下 PPP的信息字段放入的数据是IP数据报时 数据链路层的可靠信息并不能保证网络层的信息可靠
帧检验序列FCS能保证无差错的接收

6. ppp协议的工作状态
1. 用户接入ISP时 路由器的调制解调器对拨号做出确认 建立一条物理链路(物理层搭建完成)
2. PC机向路由器发送一系列LCP分组(包含多个PPP帧) // 通过建立的物理链路
3. 这些分组响应选择一部分PPP参数 和？？？进行网络配置 NCP给PC机分配一个IP地址 PC机成为主机(联网) 
4. 通信完毕后 NCP释放网络层连接 收回IP地址 LCP收回数据链路连接  最后释放物理层连接

网络链路层被分为了LCP和NCP两个子层LCP负责对接物理层吗 NCP则是对接网络层？
![](photo/pppState.png)
## 使用广播信道的数据链路层
### 局域网的的数据链路层
1. 局域网的特点
2. 局域网的优点
3. 媒体共享技术
+ 静态划分信道
频分复用
时分复用
波分复用
码分复用
+ 动态媒体接入控制
随机接入
受控接入
5. 数据链路层子层
### 适配器的作用

###  以太网
**概念** 以太网是符合 DIX Ethernet V2标准的局域网 IEEE 802.3局域网也简称以太网
1. 局域网的数据链路层拆分
## 使用广播信道的以太网

## 扩展的以太网

## 高速以太网

## 其他类型的告诉局域网接口

## 额外问题
1. 数据链路层的物理实现和物理载体
2. 数据链路层的逻辑协议
3. 数据链路层实际在网络传输做的流程和事情 并且使用的载体

